<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>TON TEMPLE</title>

  <style>
    :root{
      --bg0:#050505;
      --gold:#d8b35a;
      --gold2:#f3d889;
      --text:#f2f2f2;
      --muted:rgba(242,242,242,.72);
      --line:rgba(216,179,90,.22);
      --line2:rgba(216,179,90,.12);
      --shadow: 0 24px 70px rgba(0,0,0,.6);

      --safeT: env(safe-area-inset-top);
      --safeB: env(safe-area-inset-bottom);
      --safeL: env(safe-area-inset-left);
      --safeR: env(safe-area-inset-right);

      --radius: 26px;
      --pill: 999px;
      --maxW: 860px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{
      color:var(--text);
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
      background:
        radial-gradient(1200px 900px at 50% 18%, rgba(216,179,90,.14), rgba(0,0,0,0) 62%),
        radial-gradient(900px 700px at 20% 55%, rgba(216,179,90,.08), rgba(0,0,0,0) 58%),
        radial-gradient(1100px 900px at 80% 65%, rgba(216,179,90,.06), rgba(0,0,0,0) 62%),
        linear-gradient(180deg, #060606, #000);
      overflow-x:hidden;
    }

    /* Page container with safe-areas */
    .wrap{
      min-height:100%;
      padding:
        calc(14px + var(--safeT))
        calc(14px + var(--safeR))
        calc(16px + var(--safeB))
        calc(14px + var(--safeL));
      display:flex;
      justify-content:center;
    }

    .stage{
      width:min(var(--maxW), 100%);
    }

    /* Header */
    .header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 0;
      flex: 1 1 auto;
    }

    .seal{
      width:52px;
      height:52px;
      border-radius:999px;
      position:relative;
      flex:0 0 auto;

      background:
        radial-gradient(60% 60% at 30% 25%, rgba(255,255,255,.24), rgba(0,0,0,0) 55%),
        radial-gradient(130% 130% at 50% 92%, rgba(216,179,90,.36), rgba(0,0,0,.78) 62%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.28));

      border:1px solid rgba(216,179,90,.50);
      box-shadow:
        0 18px 55px rgba(0,0,0,.85),
        inset 0 0 22px rgba(216,179,90,.18);
    }
    .seal:before{
      content:"";
      position:absolute;
      inset:7px;
      border-radius:999px;
      border:1px solid rgba(216,179,90,.28);
      box-shadow: inset 0 0 18px rgba(216,179,90,.10);
    }
    .seal span{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      color:var(--gold2);
      font-weight:900;
      font-size:24px;
      letter-spacing:.04em;
      text-shadow:
        0 22px 48px rgba(0,0,0,.95),
        0 0 22px rgba(216,179,90,.45);
      transform: translateY(1px);
    }

    .brandText{
      min-width:0;
      line-height:1.05;
    }
    .brandTitle{
      font-weight:900;
      letter-spacing:.20em;
      font-size:19px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brandSub{
      margin-top:6px;
      font-size:13px;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Right cluster */
    .cluster{
      flex: 0 0 auto;
      display:flex;
      align-items:flex-start;
      justify-content:flex-end;
      gap:10px;
    }

    /* Two-row controls block */
    .controls{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
    }

    .row{
      display:flex;
      align-items:center;
      gap:10px;
      justify-content:flex-end;
    }

    /* merged pills */
    .seg{
      display:inline-flex;
      border:1px solid rgba(216,179,90,.22);
      background: rgba(10,10,10,.40);
      border-radius: var(--pill);
      padding:3px;
      box-shadow: inset 0 0 16px rgba(216,179,90,.06);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }

    .seg button{
      border:0;
      background:transparent;
      color:rgba(242,242,242,.82);
      padding:8px 12px;
      border-radius: var(--pill);
      font-weight:800;
      letter-spacing:.16em;
      font-size:12px;
      cursor:pointer;
      min-width: 72px;
      white-space:nowrap;
    }

    .seg button.active{
      background:
        radial-gradient(120% 120% at 35% 25%, rgba(255,255,255,.12), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(216,179,90,.30), rgba(0,0,0,.18));
      color:#111;
      box-shadow:
        0 14px 34px rgba(0,0,0,.55),
        inset 0 0 18px rgba(255,255,255,.10);
      border:1px solid rgba(216,179,90,.35);
    }

    .seg.segLang button{ min-width: 64px; letter-spacing:.10em; }
    .seg.segLang button.active{ color:#111; }

    .iconBtn{
      width:40px;
      height:40px;
      border-radius:999px;
      border:1px solid rgba(216,179,90,.18);
      background: rgba(12,12,12,.45);
      color: rgba(242,242,242,.88);
      display:grid;
      place-items:center;
      cursor:pointer;
      box-shadow: inset 0 0 16px rgba(216,179,90,.06);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .iconBtn:active{ transform: translateY(1px); }
    .iconBtn span{ font-weight:900; }

    /* Main card */
    .card{
      margin-top: 8px;
      border-radius: var(--radius);
      border:1px solid rgba(216,179,90,.18);
      background:
        radial-gradient(1200px 600px at 50% 0%, rgba(216,179,90,.10), rgba(0,0,0,0) 55%),
        rgba(0,0,0,.38);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }

    .card:before{
      content:"";
      position:absolute;
      inset:0;
      background:
        radial-gradient(700px 420px at 35% 25%, rgba(216,179,90,.10), rgba(0,0,0,0) 60%),
        radial-gradient(700px 420px at 75% 55%, rgba(216,179,90,.08), rgba(0,0,0,0) 60%);
      pointer-events:none;
    }

    .inner{
      padding: 18px;
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .sigilBox{
      border-radius: 22px;
      border:1px solid rgba(216,179,90,.18);
      background: rgba(0,0,0,.30);
      box-shadow: inset 0 0 24px rgba(216,179,90,.06);
      height: min(52vh, 520px);
      min-height: 340px;
      display:grid;
      place-items:center;
      position:relative;
      overflow:hidden;
    }

    .sigilBox:before{
      content:"";
      position:absolute;
      inset:14px;
      border-radius: 18px;
      border:1px solid rgba(216,179,90,.12);
      pointer-events:none;
    }

    .sigilCircle{
      width:min(64%, 300px);
      aspect-ratio: 1 / 1;
      border-radius:999px;
      border:1px solid rgba(216,179,90,.18);
      display:grid;
      place-items:center;
      box-shadow: inset 0 0 40px rgba(216,179,90,.06);
      background:
        radial-gradient(60% 60% at 40% 30%, rgba(216,179,90,.10), rgba(0,0,0,0) 62%),
        rgba(0,0,0,.18);
    }

    .sigilChar{
      font-size: clamp(58px, 6.6vw, 86px);
      font-weight: 900;
      color: var(--gold2);
      text-shadow:
        0 24px 70px rgba(0,0,0,.95),
        0 0 20px rgba(216,179,90,.35);
      transform: translateY(2px);
    }

    /* Buttons */
    .btn{
      border-radius: 18px;
      border:1px solid rgba(216,179,90,.22);
      background:
        radial-gradient(120% 120% at 35% 25%, rgba(255,255,255,.10), rgba(0,0,0,0) 60%),
        rgba(0,0,0,.25);
      color: rgba(242,242,242,.90);
      padding: 14px 16px;
      font-weight:900;
      letter-spacing:.20em;
      cursor:pointer;
      text-align:center;
      box-shadow:
        0 18px 50px rgba(0,0,0,.65),
        inset 0 0 18px rgba(216,179,90,.08);
      user-select:none;
    }
    .btn:active{ transform: translateY(1px); }

    .btnPrimary{
      background:
        radial-gradient(120% 120% at 35% 25%, rgba(255,255,255,.14), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(216,179,90,.28), rgba(0,0,0,.20));
      border:1px solid rgba(216,179,90,.32);
      color:#121212;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }

    /* Forecast panel */
    .panel{
      border-radius: 22px;
      border:1px solid rgba(216,179,90,.18);
      background: rgba(0,0,0,.28);
      box-shadow: inset 0 0 20px rgba(216,179,90,.06);
      padding: 14px;
    }

    .panelTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }

    .panelTitle{
      font-weight:900;
      letter-spacing:.18em;
      font-size: 13px;
      color: rgba(242,242,242,.92);
    }

    .chips{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .chip{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(216,179,90,.18);
      background: rgba(0,0,0,.22);
      font-weight:800;
      letter-spacing:.14em;
      font-size: 11px;
      color: rgba(242,242,242,.80);
      white-space:nowrap;
    }
    .chip.active{
      background:
        radial-gradient(120% 120% at 35% 25%, rgba(255,255,255,.12), rgba(0,0,0,0) 60%),
        linear-gradient(180deg, rgba(216,179,90,.26), rgba(0,0,0,.18));
      color:#111;
      border:1px solid rgba(216,179,90,.28);
    }

    .label{
      margin-top:6px;
      color: rgba(242,242,242,.72);
      font-size: 12px;
      line-height:1.5;
    }

    .actions3{
      margin-top:12px;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    .btnSmall{
      padding:12px 10px;
      border-radius: 16px;
      font-size: 12px;
      letter-spacing:.18em;
      font-weight:900;
    }

    .foot{
      margin-top:10px;
      text-align:center;
      color: rgba(242,242,242,.52);
      font-size: 12px;
    }

    /* Modal */
    .modalBack{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.72);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index:9999;
    }
    .modal{
      width:min(520px, 100%);
      border-radius: 22px;
      border:1px solid rgba(216,179,90,.22);
      background:
        radial-gradient(700px 360px at 35% 15%, rgba(216,179,90,.12), rgba(0,0,0,0) 62%),
        rgba(0,0,0,.62);
      box-shadow: 0 28px 90px rgba(0,0,0,.85);
      padding:16px;
    }
    .modal h3{
      margin:0 0 8px 0;
      font-size: 14px;
      letter-spacing:.16em;
    }
    .modal p{
      margin:0;
      color: rgba(242,242,242,.78);
      font-size: 13px;
      line-height:1.5;
    }
    .modal .closeRow{
      margin-top:14px;
      display:flex;
      justify-content:flex-end;
    }

    /* Mobile tightening */
    @media (max-width: 420px){
      .seal{ width:48px; height:48px; }
      .seal span{ font-size:22px; }
      .brandTitle{ font-size:17px; letter-spacing:.18em; }
      .brandSub{ font-size:12px; }
      .seg button{ padding:7px 10px; min-width: 66px; font-size:11px; }
      .seg.segLang button{ min-width: 58px; }
      .iconBtn{ width:38px; height:38px; }
      .inner{ padding: 16px; }
      .sigilBox{ min-height: 320px; }
    }

    /* Prevent selection / context menu (Telegram Android) */
    body{
      -webkit-user-select:none;
      user-select:none;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="stage">

      <div class="header">
        <!-- BRAND LEFT -->
        <div class="brand">
          <div class="seal" aria-hidden="true"><span>è´¢</span></div>
          <div class="brandText">
            <div class="brandTitle" id="brandTitle">TON TEMPLE</div>
            <div class="brandSub" id="brandSub">Fa Cai Supreme AI</div>
          </div>
        </div>

        <!-- CONTROLS RIGHT -->
        <div class="cluster">
          <div class="controls">
            <!-- Row 1: Ritual/Pro + (?) (must be right of PRO) -->
            <div class="row">
              <div class="seg" role="tablist" aria-label="Mode">
                <button id="tabRitual" class="active" type="button" data-i18n="ui.ritual">RITUAL</button>
                <button id="tabPro" type="button" data-i18n="ui.pro">PRO</button>
              </div>
              <button class="iconBtn" id="helpBtn" type="button" aria-label="Help" title="Help">
                <span>?</span>
              </button>
            </div>

            <!-- Row 2: CN/EN + sound (sound must be under ?) -->
            <div class="row">
              <div class="seg segLang" role="tablist" aria-label="Language">
                <button id="langZH" class="active" type="button">ä¸­æ–‡</button>
                <button id="langEN" type="button">EN</button>
              </div>
              <button class="iconBtn" id="soundBtn" type="button" aria-label="Sound" title="Sound">
                <span id="soundIcon">ðŸ”Š</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="inner">
          <div class="sigilBox">
            <div class="sigilCircle" aria-hidden="true">
              <div class="sigilChar">è´¢</div>
            </div>
          </div>

          <button class="btn btnPrimary" id="activate" type="button" data-i18n="ui.activate">
            ACTIVATE FLOW
          </button>

          <div class="grid2">
            <button class="btn" id="oracle" type="button" data-i18n="ui.oracle">ORACLE</button>
            <button class="btn" id="altar" type="button" data-i18n="ui.altar">GOLDEN ALTAR</button>
          </div>

          <div class="panel">
            <div class="panelTop">
              <div class="panelTitle" data-i18n="ui.forecast">FORECAST</div>
              <div class="chips">
                <div class="chip active" id="chipDay" data-i18n="ui.day">DAY</div>
                <div class="chip" id="chipTon" data-i18n="ui.ton">TON</div>
                <div class="chip" id="chipLimit"><span data-i18n="ui.limit">LIMIT</span>: <span id="limitVal">1/1</span></div>
              </div>
            </div>

            <div class="panelTitle" style="margin-top:2px;" data-i18n="ui.guidanceTitle">
              TEMPLE GUIDANCE:
            </div>

            <div class="label" id="guidanceText" data-i18n="ui.guidanceText">
              Signal: donâ€™t scatter attention. One step â€” one result.
            </div>

            <div class="actions3">
              <button class="btn btnSmall" id="enterBtn" type="button" data-i18n="ui.enter">ENTER</button>
              <button class="btn btnSmall" id="waitBtn" type="button" data-i18n="ui.wait">WAIT</button>
              <button class="btn btnSmall" id="skipBtn" type="button" data-i18n="ui.skip">SKIP</button>
            </div>

            <div class="foot" data-i18n="ui.disclaimer">
              Ritualized interface. Not financial advice.
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- HELP MODAL -->
  <div class="modalBack" id="modalBack" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="modal">
      <h3 id="helpTitle" data-i18n="help.title">TEMPLE HELP</h3>
      <p id="helpBody" data-i18n="help.body">
        This is a ritual UI layer. Use Oracle for guidance, then choose Enter / Wait / Skip.
      </p>
      <div class="closeRow">
        <button class="btn btnSmall" id="closeHelp" type="button" data-i18n="help.close">CLOSE</button>
      </div>
    </div>
  </div>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    // Telegram lifecycle
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
    }

    // Prevent context menu (Telegram Android)
    window.addEventListener("contextmenu", e => e.preventDefault());

    // State
    let currentLang = "zh";
    let soundOn = true;

    // Full translations (EVERY UI string)
    const I18N = {
      zh: {
        "ui.ritual": "ä»ªå¼",
        "ui.pro": "PRO",
        "ui.activate": "å¯åŠ¨æµ",
        "ui.oracle": "ç¥žè°•",
        "ui.altar": "é‡‘å›",
        "ui.forecast": "é¢„æµ‹",
        "ui.day": "æ—¥",
        "ui.ton": "TON",
        "ui.limit": "é¢åº¦",
        "ui.guidanceTitle": "åº™å ‚æŒ‡å¼•ï¼š",
        "ui.guidanceText": "ä¿¡å·ï¼šä¸è¦åˆ†æ•£æ³¨æ„åŠ›ã€‚ä¸€ä¸€æ­¥â€”â€”ä¸€ä¸ªç»“æžœã€‚",
        "ui.enter": "è¿›å…¥",
        "ui.wait": "ç­‰å¾…",
        "ui.skip": "è·³è¿‡",
        "ui.disclaimer": "ä»ªå¼åŒ–ç•Œé¢ã€‚éžæŠ•èµ„å»ºè®®ã€‚",
        "help.title": "åº™å ‚å¸®åŠ©",
        "help.body": "è¿™æ˜¯ä»ªå¼åŒ–ç•Œé¢å±‚ã€‚ç‚¹å‡»ã€Œç¥žè°•ã€èŽ·å–æŒ‡å¼•ï¼Œç„¶åŽé€‰æ‹©ï¼šè¿›å…¥ / ç­‰å¾… / è·³è¿‡ã€‚",
        "help.close": "å…³é—­"
      },
      en: {
        "ui.ritual": "RITUAL",
        "ui.pro": "PRO",
        "ui.activate": "ACTIVATE FLOW",
        "ui.oracle": "ORACLE",
        "ui.altar": "GOLDEN ALTAR",
        "ui.forecast": "FORECAST",
        "ui.day": "DAY",
        "ui.ton": "TON",
        "ui.limit": "LIMIT",
        "ui.guidanceTitle": "TEMPLE GUIDANCE:",
        "ui.guidanceText": "Signal: donâ€™t scatter attention. One step â€” one result.",
        "ui.enter": "ENTER",
        "ui.wait": "WAIT",
        "ui.skip": "SKIP",
        "ui.disclaimer": "Ritualized interface. Not financial advice.",
        "help.title": "TEMPLE HELP",
        "help.body": "This is a ritual UI layer. Tap ORACLE for guidance, then choose: Enter / Wait / Skip.",
        "help.close": "CLOSE"
      }
    };

    function applyI18n(lang){
      currentLang = lang;
      document.documentElement.lang = (lang === "zh") ? "zh" : "en";

      // buttons active state
      document.getElementById("langZH").classList.toggle("active", lang === "zh");
      document.getElementById("langEN").classList.toggle("active", lang === "en");

      // apply all keys
      document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        const v = I18N[lang]?.[key];
        if (typeof v === "string") el.textContent = v;
      });
    }

    // Default CN
    applyI18n("zh");

    // Language buttons
    document.getElementById("langZH").addEventListener("click", () => applyI18n("zh"));
    document.getElementById("langEN").addEventListener("click", () => applyI18n("en"));

    // Mode buttons (visual only for now)
    document.getElementById("tabRitual").addEventListener("click", () => {
      document.getElementById("tabRitual").classList.add("active");
      document.getElementById("tabPro").classList.remove("active");
    });
    document.getElementById("tabPro").addEventListener("click", () => {
      document.getElementById("tabPro").classList.add("active");
      document.getElementById("tabRitual").classList.remove("active");
    });

    // Help modal
    const modalBack = document.getElementById("modalBack");
    const openHelp = () => { modalBack.style.display = "flex"; if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred("light"); };
    const closeHelp = () => { modalBack.style.display = "none"; };

    document.getElementById("helpBtn").addEventListener("click", openHelp);
    document.getElementById("closeHelp").addEventListener("click", closeHelp);
    modalBack.addEventListener("click", (e) => { if (e.target === modalBack) closeHelp(); });

    // Sound
    document.getElementById("soundBtn").addEventListener("click", () => {
      soundOn = !soundOn;
      document.getElementById("soundIcon").textContent = soundOn ? "ðŸ”Š" : "ðŸ”‡";
      if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred("light");
    });

    // Core buttons (stub)
    document.getElementById("activate").addEventListener("click", () => {
      if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred("medium");
      // Placeholder action
    });

    document.getElementById("oracle").addEventListener("click", () => {
      if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred("light");
      // Placeholder: could request signal from bot later
    });

    // Chips
    document.getElementById("chipDay").addEventListener("click", () => {
      document.getElementById("chipDay").classList.add("active");
      document.getElementById("chipTon").classList.remove("active");
    });
    document.getElementById("chipTon").addEventListener("click", () => {
      document.getElementById("chipTon").classList.add("active");
      document.getElementById("chipDay").classList.remove("active");
    });

    // Actions
    ["enterBtn","waitBtn","skipBtn"].forEach(id=>{
      document.getElementById(id).addEventListener("click", ()=>{
        if (tg?.HapticFeedback) tg.HapticFeedback.impactOccurred("light");
      });
    });
  </script>
</body>
</html>
